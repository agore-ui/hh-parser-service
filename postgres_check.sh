#!/bin/bash

# ============================================================================
# PostgreSQL Configuration ะธ Connection Check Script
# ============================================================================
# ะัะพะฒะตััะตั ะบะพััะตะบัะฝะพััั ะฝะฐัััะพะนะบะธ PostgreSQL ะธ ะฟะพะดะบะปััะตะฝะธะต
# ะะตััะธั: 1.0
# ะะฐัะฐ: 2026-01-20
# ============================================================================

# ะฆะฒะตัะฐ ะดะปั ะฒัะฒะพะดะฐ
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# ะะฐัะฐะผะตััั
DB_USER="hh_parser_user"
DB_NAME="hh_parser"
DB_PASSWORD="change_me_in_production_123456"
DB_HOST_IPV4="127.0.0.1"
DB_HOST_IPv6="::1"
POSTGRES_SUPERUSER="postgres"
PG_VERSION="14"

# ะกัะตััะธะบะธ
CHECKS_PASSED=0
CHECKS_FAILED=0

echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${BLUE}โ  ๐ง PostgreSQL Configuration Check v1.0                   โ${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo ""

# ============================================================================
# ะคะฃะะะฆะะฏ: ะัะพะฒะตัะบะฐ ั ะทะตะปะตะฝะพะน ะณะฐะปะพัะบะพะน
# ============================================================================
check_pass() {
    local message="$1"
    echo -e "${GREEN}โ PASS${NC}: $message"
    ((CHECKS_PASSED++))
}

# ============================================================================
# ะคะฃะะะฆะะฏ: ะัะพะฒะตัะบะฐ ั ะบัะฐัะฝัะผ ะบัะตััะพะผ
# ============================================================================
check_fail() {
    local message="$1"
    echo -e "${RED}โ FAIL${NC}: $message"
    ((CHECKS_FAILED++))
}

# ============================================================================
# ะคะฃะะะฆะะฏ: ะะฝัะพัะผะฐัะธะพะฝะฝะพะต ัะพะพะฑัะตะฝะธะต
# ============================================================================
check_info() {
    local message="$1"
    echo -e "${YELLOW}โน๏ธ  INFO${NC}: $message"
}

# ============================================================================
# ะคะฃะะะฆะะฏ: ะะฐะณะพะปะพะฒะพะบ ัะตะบัะธะธ
# ============================================================================
section_header() {
    local title="$1"
    echo ""
    echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
    echo -e "${BLUE}๐ $title${NC}"
    echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
}

# ============================================================================
# ะกะะะฆะะฏ 1: ะัะพะฒะตัะบะฐ ัะธััะตะผั
# ============================================================================
section_header "1. ะัะพะฒะตัะบะฐ ัะธััะตะผั"

# ะัะพะฒะตัะบะฐ, ััะพ ัะบัะธะฟั ะทะฐะฟััะตะฝ ะพั root
if [[ $EUID -eq 0 ]]; then
    check_pass "ะกะบัะธะฟั ะทะฐะฟััะตะฝ ะพั ะฟะพะปัะทะพะฒะฐัะตะปั root"
else
    check_info "ะกะบัะธะฟั ะทะฐะฟััะตะฝ ะฝะต ะพั root. ะะตะบะพัะพััะต ะฟัะพะฒะตัะบะธ ััะตะฑััั sudo"
fi

# ะัะพะฒะตัะบะฐ ะฒะตััะธะธ Ubuntu
if command -v lsb_release &> /dev/null; then
    UBUNTU_VERSION=$(lsb_release -rs)
    check_pass "Ubuntu ะฒะตััะธั: $UBUNTU_VERSION"
else
    check_fail "lsb_release ะฝะต ะฝะฐะนะดะตะฝะฐ"
fi

# ============================================================================
# ะกะะะฆะะฏ 2: ะัะพะฒะตัะบะฐ ัััะฐะฝะพะฒะบะธ PostgreSQL
# ============================================================================
section_header "2. ะัะพะฒะตัะบะฐ ัััะฐะฝะพะฒะบะธ PostgreSQL"

# ะัะพะฒะตัะบะฐ ัััะฐะฝะพะฒะบะธ psql
if command -v psql &> /dev/null; then
    PSQL_VERSION=$(psql --version)
    check_pass "PostgreSQL ัััะฐะฝะพะฒะปะตะฝ: $PSQL_VERSION"
else
    check_fail "PostgreSQL (psql) ะฝะต ัััะฐะฝะพะฒะปะตะฝ"
    echo -e "${YELLOW}๐ก ะฃััะฐะฝะพะฒะธัะต: sudo apt install postgresql postgresql-contrib${NC}"
    exit 1
fi

# ะัะพะฒะตัะบะฐ ัะตัะฒะธัะฐ PostgreSQL
if sudo systemctl is-active --quiet postgresql; then
    check_pass "ะกะตัะฒะธั PostgreSQL ะทะฐะฟััะตะฝ"
else
    check_fail "ะกะตัะฒะธั PostgreSQL ะฝะต ะทะฐะฟััะตะฝ"
    echo -e "${YELLOW}๐ก ะะฐะฟัััะธัะต: sudo systemctl start postgresql${NC}"
    exit 1
fi

# ะัะพะฒะตัะบะฐ ะฐะฒัะพะทะฐะฟััะบะฐ
if sudo systemctl is-enabled --quiet postgresql; then
    check_pass "PostgreSQL ะฒะบะปััะตะฝ ะฝะฐ ะฐะฒัะพะทะฐะฟััะบ"
else
    check_fail "PostgreSQL ะฝะต ะฒะบะปััะตะฝ ะฝะฐ ะฐะฒัะพะทะฐะฟััะบ"
    echo -e "${YELLOW}๐ก ะะบะปััะธัะต: sudo systemctl enable postgresql${NC}"
fi

# ============================================================================
# ะกะะะฆะะฏ 3: ะัะพะฒะตัะบะฐ ะฟะพััะพะฒ
# ============================================================================
section_header "3. ะัะพะฒะตัะบะฐ ะฟะพััะพะฒ ะธ ะฟัะพัะปััะธะฒะฐะฝะธั"

# ะัะพะฒะตัะบะฐ, ััะพ PostgreSQL ัะปััะฐะตั ะฝะฐ localhost
if sudo netstat -tlnp 2>/dev/null | grep -q ":5432.*LISTEN"; then
    check_pass "PostgreSQL ัะปััะฐะตั ะฝะฐ ะฟะพััั 5432"
    sudo netstat -tlnp 2>/dev/null | grep ":5432.*LISTEN" | sed 's/^/   /'
else
    check_fail "PostgreSQL ะฝะต ัะปััะฐะตั ะฝะฐ ะฟะพััั 5432"
    exit 1
fi

# ============================================================================
# ะกะะะฆะะฏ 4: ะัะพะฒะตัะบะฐ pg_hba.conf
# ============================================================================
section_header "4. ะัะพะฒะตัะบะฐ ะบะพะฝัะธะณััะฐัะธะธ pg_hba.conf"

PG_HBA_PATH="/etc/postgresql/${PG_VERSION}/main/pg_hba.conf"

if [ -f "$PG_HBA_PATH" ]; then
    check_pass "ะคะฐะนะป pg_hba.conf ะฝะฐะนะดะตะฝ: $PG_HBA_PATH"
    
    # ะัะพะฒะตัะบะฐ ัััะพะบ ะฐััะตะฝัะธัะธะบะฐัะธะธ
    echo -e "\n${YELLOW}ะะตะปะตะฒะฐะฝัะฝัะต ัััะพะบะธ ะธะท pg_hba.conf:${NC}"
    sudo grep -v "^#" "$PG_HBA_PATH" | grep -v "^$" | grep -E "local|host" | sed 's/^/   /'
    
    # ะัะพะฒะตัะบะฐ IPv4 md5/scram-sha-256
    if sudo grep -q "^host.*127.0.0.1.*md5\|^host.*127.0.0.1.*scram-sha-256" "$PG_HBA_PATH"; then
        check_pass "IPv4 (127.0.0.1/32) ะธัะฟะพะปัะทัะตั md5 ะธะปะธ scram-sha-256"
    else
        check_fail "IPv4 (127.0.0.1/32) ะฝะต ะฝะฐัััะพะตะฝ ะดะปั md5/scram-sha-256"
    fi
    
    # ะัะพะฒะตัะบะฐ IPv6 md5/scram-sha-256
    if sudo grep -q "^host.*::1.*md5\|^host.*::1.*scram-sha-256" "$PG_HBA_PATH"; then
        check_pass "IPv6 (::1/128) ะธัะฟะพะปัะทัะตั md5 ะธะปะธ scram-sha-256"
    else
        check_fail "IPv6 (::1/128) ะฝะต ะฝะฐัััะพะตะฝ ะดะปั md5/scram-sha-256"
    fi
else
    check_fail "ะคะฐะนะป pg_hba.conf ะฝะต ะฝะฐะนะดะตะฝ ะฟะพ ะฟััะธ: $PG_HBA_PATH"
    exit 1
fi

# ============================================================================
# ะกะะะฆะะฏ 5: ะัะพะฒะตัะบะฐ ะฟะพะปัะทะพะฒะฐัะตะปั PostgreSQL
# ============================================================================
section_header "5. ะัะพะฒะตัะบะฐ ะฟะพะปัะทะพะฒะฐัะตะปั ะธ ะฑะฐะทั ะดะฐะฝะฝัั"

# ะัะพะฒะตัะบะฐ ัััะตััะฒะพะฒะฐะฝะธั ะฟะพะปัะทะพะฒะฐัะตะปั
if sudo -u postgres psql -tAc "SELECT 1 FROM pg_user WHERE usename='$DB_USER'" 2>/dev/null | grep -q 1; then
    check_pass "ะะพะปัะทะพะฒะฐัะตะปั '$DB_USER' ัััะตััะฒัะตั"
else
    check_fail "ะะพะปัะทะพะฒะฐัะตะปั '$DB_USER' ะฝะต ะฝะฐะนะดะตะฝ"
fi

# ะัะพะฒะตัะบะฐ ัััะตััะฒะพะฒะฐะฝะธั ะะ
if sudo -u postgres psql -tAc "SELECT 1 FROM pg_database WHERE datname='$DB_NAME'" 2>/dev/null | grep -q 1; then
    check_pass "ะะฐะทะฐ ะดะฐะฝะฝัั '$DB_NAME' ัััะตััะฒัะตั"
else
    check_fail "ะะฐะทะฐ ะดะฐะฝะฝัั '$DB_NAME' ะฝะต ะฝะฐะนะดะตะฝะฐ"
fi

# ะัะพะฒะตัะบะฐ ะฟัะฐะฒ ะดะพัััะฟะฐ
if sudo -u postgres psql -tAc "SELECT 1 FROM pg_database WHERE datname='$DB_NAME' AND pg_get_userbyid(datdba)='$DB_USER'" 2>/dev/null | grep -q 1; then
    check_pass "ะะพะปัะทะพะฒะฐัะตะปั '$DB_USER' ัะฒะปัะตััั ะฒะปะฐะดะตะปััะตะผ ะะ '$DB_NAME'"
else
    check_info "ะะพะปัะทะพะฒะฐัะตะปั ะผะพะถะตั ะฝะต ะฑััั ะฒะปะฐะดะตะปััะตะผ ะะ (ะฟัะพะฒะตัััะต ะฒัััะฝัั)"
fi

# ============================================================================
# ะกะะะฆะะฏ 6: ะัะพะฒะตัะบะฐ ะฟะพะดะบะปััะตะฝะธั ั ะฟะฐัะพะปะตะผ
# ============================================================================
section_header "6. ะัะพะฒะตัะบะฐ ะฟะพะดะบะปััะตะฝะธั ั ะฟะฐัะพะปะตะผ"

# ะขะตัั 1: ะะพะดะบะปััะตะฝะธะต ัะตัะตะท IPv4 (127.0.0.1)
check_info "ะะพะฟััะบะฐ ะฟะพะดะบะปััะตะฝะธั ัะตัะตะท IPv4 (127.0.0.1)..."
if PGPASSWORD="$DB_PASSWORD" psql -h 127.0.0.1 -U "$DB_USER" -d "$DB_NAME" -c "SELECT 1;" &>/dev/null; then
    check_pass "ะะพะดะบะปััะตะฝะธะต ัะตัะตะท IPv4 (127.0.0.1) ััะฟะตัะฝะพ"
else
    check_fail "ะะพะดะบะปััะตะฝะธะต ัะตัะตะท IPv4 (127.0.0.1) ะฝะต ัะดะฐะปะพัั"
fi

# ะขะตัั 2: ะะพะดะบะปััะตะฝะธะต ัะตัะตะท localhost (ะผะพะถะตั ะฑััั IPv4 ะธะปะธ IPv6)
check_info "ะะพะฟััะบะฐ ะฟะพะดะบะปััะตะฝะธั ัะตัะตะท localhost..."
if PGPASSWORD="$DB_PASSWORD" psql -h localhost -U "$DB_USER" -d "$DB_NAME" -c "SELECT 1;" &>/dev/null; then
    check_pass "ะะพะดะบะปััะตะฝะธะต ัะตัะตะท localhost ััะฟะตัะฝะพ"
else
    check_fail "ะะพะดะบะปััะตะฝะธะต ัะตัะตะท localhost ะฝะต ัะดะฐะปะพัั"
    check_info "ะญัะพ ะผะพะถะตั ะฑััั ะฟัะพะฑะปะตะผะฐ ั IPv6. ะัะพะฒะตัััะต pg_hba.conf ะดะปั ::1"
fi

# ะขะตัั 3: ะะพะดะบะปััะตะฝะธะต ะฑะตะท ัะบะฐะทะฐะฝะธั ัะพััะฐ (Unix socket)
check_info "ะะพะฟััะบะฐ ะฟะพะดะบะปััะตะฝะธั ัะตัะตะท Unix socket..."
if PGPASSWORD="$DB_PASSWORD" psql -U "$DB_USER" -d "$DB_NAME" -c "SELECT 1;" &>/dev/null; then
    check_pass "ะะพะดะบะปััะตะฝะธะต ัะตัะตะท Unix socket ััะฟะตัะฝะพ"
else
    check_fail "ะะพะดะบะปััะตะฝะธะต ัะตัะตะท Unix socket ะฝะต ัะดะฐะปะพัั"
fi

# ============================================================================
# ะกะะะฆะะฏ 7: ะะพะปััะตะฝะธะต ะธะฝัะพัะผะฐัะธะธ ะพ ะะ
# ============================================================================
section_header "7. ะะฝัะพัะผะฐัะธั ะพ ะฑะฐะทะต ะดะฐะฝะฝัั"

# ะะพะฟััะบะฐ ะฟะพะปััะธัั ะฒะตััะธั PostgreSQL ัะตัะตะท ะฟะพะดะบะปััะตะฝะธะต ั ะฟะฐัะพะปะตะผ
if PGPASSWORD="$DB_PASSWORD" psql -h 127.0.0.1 -U "$DB_USER" -d "$DB_NAME" -c "SELECT version();" 2>/dev/null | head -1 | grep -q "PostgreSQL"; then
    check_pass "ะะพะปััะตะฝะฐ ะธะฝัะพัะผะฐัะธั ะพ ะฒะตััะธะธ PostgreSQL:"
    PGPASSWORD="$DB_PASSWORD" psql -h 127.0.0.1 -U "$DB_USER" -d "$DB_NAME" -c "SELECT version();" | sed 's/^/   /'
else
    check_info "ะะต ัะดะฐะปะพัั ะฟะพะปััะธัั ะฒะตััะธั PostgreSQL ัะตัะตะท ะฟะพะปัะทะพะฒะฐัะตะปั hh_parser"
    # ะััะฐะตะผัั ัะตัะตะท sudo
    if sudo -u postgres psql -c "SELECT version();" 2>/dev/null | head -1 | grep -q "PostgreSQL"; then
        sudo -u postgres psql -c "SELECT version();" | sed 's/^/   /'
    fi
fi

# ============================================================================
# ะกะะะฆะะฏ 8: ะัะพะฒะตัะบะฐ ัะฐะฑะปะธั ะฒ ะะ
# ============================================================================
section_header "8. ะัะพะฒะตัะบะฐ ัะฐะฑะปะธั ะฒ ะฑะฐะทะต ะดะฐะฝะฝัั"

# ะะพะปััะตะฝะธะต ะบะพะปะธัะตััะฒะฐ ัะฐะฑะปะธั
TABLE_COUNT=$(PGPASSWORD="$DB_PASSWORD" psql -h 127.0.0.1 -U "$DB_USER" -d "$DB_NAME" -tAc "SELECT COUNT(*) FROM information_schema.tables WHERE table_schema = 'public';" 2>/dev/null)

if [ -z "$TABLE_COUNT" ]; then
    check_fail "ะะต ัะดะฐะปะพัั ะฟะพะดะบะปััะธัััั ะบ ะะ ะดะปั ะฟัะพะฒะตัะบะธ ัะฐะฑะปะธั"
elif [ "$TABLE_COUNT" -eq 0 ]; then
    check_info "ะะฐะทะฐ ะดะฐะฝะฝัั ะฟัััะฐ (ัะฐะฑะปะธั ะฝะต ะฝะฐะนะดะตะฝะพ)"
else
    check_pass "ะะฐะนะดะตะฝะพ ัะฐะฑะปะธั ะฒ ะะ: $TABLE_COUNT"
    check_info "ะกะฟะธัะพะบ ัะฐะฑะปะธั:"
    PGPASSWORD="$DB_PASSWORD" psql -h 127.0.0.1 -U "$DB_USER" -d "$DB_NAME" -c "\dt" 2>/dev/null | sed 's/^/   /'
fi

# ============================================================================
# ะกะะะฆะะฏ 9: ะัะพะฒะตัะบะฐ ัะฐะทะผะตัะฐ ะะ
# ============================================================================
section_header "9. ะะฐะทะผะตั ะฑะฐะทั ะดะฐะฝะฝัั"

DB_SIZE=$(PGPASSWORD="$DB_PASSWORD" psql -h 127.0.0.1 -U "$DB_USER" -d "$DB_NAME" -tAc "SELECT pg_size_pretty(pg_database_size('$DB_NAME'));" 2>/dev/null)

if [ -z "$DB_SIZE" ]; then
    check_fail "ะะต ัะดะฐะปะพัั ะพะฟัะตะดะตะปะธัั ัะฐะทะผะตั ะะ"
else
    check_pass "ะะฐะทะผะตั ะะ: $DB_SIZE"
fi

# ============================================================================
# ะกะะะฆะะฏ 10: ะัะพะฒะตัะบะฐ ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั
# ============================================================================
section_header "10. ะัะพะฒะตัะบะฐ ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั ะฟัะธะปะพะถะตะฝะธั"

ENV_FILE="/opt/hh_parser_service/.env"

if [ -f "$ENV_FILE" ]; then
    check_pass "ะคะฐะนะป .env ะฝะฐะนะดะตะฝ: $ENV_FILE"
    
    # ะัะพะฒะตัะบะฐ DATABASE_URL
    if grep -q "^DATABASE_URL=" "$ENV_FILE"; then
        check_pass "ะะตัะตะผะตะฝะฝะฐั DATABASE_URL ัััะฐะฝะพะฒะปะตะฝะฐ"
        check_info "ะกะพะดะตัะถะธะผะพะต DATABASE_URL (ะฟะตัะฒัะต 50 ัะธะผะฒะพะปะพะฒ):"
        grep "^DATABASE_URL=" "$ENV_FILE" | cut -d'=' -f2 | cut -c1-50 | sed 's/^/   /'
    else
        check_fail "ะะตัะตะผะตะฝะฝะฐั DATABASE_URL ะฝะต ะฝะฐะนะดะตะฝะฐ ะฒ .env"
    fi
    
    # ะัะพะฒะตัะบะฐ REDIS_URL
    if grep -q "^REDIS_URL=" "$ENV_FILE"; then
        check_pass "ะะตัะตะผะตะฝะฝะฐั REDIS_URL ัััะฐะฝะพะฒะปะตะฝะฐ"
    else
        check_fail "ะะตัะตะผะตะฝะฝะฐั REDIS_URL ะฝะต ะฝะฐะนะดะตะฝะฐ ะฒ .env"
    fi
else
    check_fail "ะคะฐะนะป .env ะฝะต ะฝะฐะนะดะตะฝ: $ENV_FILE"
fi

# ============================================================================
# ะกะะะฆะะฏ 11: ะะธะฐะณะฝะพััะธะบะฐ
# ============================================================================
section_header "11. ะะพะฟะพะปะฝะธัะตะปัะฝะฐั ะดะธะฐะณะฝะพััะธะบะฐ"

# ะัะพะฒะตัะบะฐ ะปะพะณะพะฒ PostgreSQL
check_info "ะะพัะปะตะดะฝะธะต ะพัะธะฑะบะธ ะฒ ะปะพะณะฐั PostgreSQL (ะตัะปะธ ะตััั):"
sudo tail -20 /var/log/postgresql/postgresql-${PG_VERSION}-main.log 2>/dev/null | grep -i "error\|fatal\|authentication" || echo "   ะัะธะฑะพะบ ะฝะต ะฝะฐะนะดะตะฝะพ"

# ะัะพะฒะตัะบะฐ ะฟัะพัะตััะพะฒ PostgreSQL
check_info "ะัะพัะตััั PostgreSQL:"
ps aux | grep -E "^postgres.*postgres" | grep -v grep | wc -l | xargs echo "   ะะพะปะธัะตััะฒะพ ะฟัะพัะตััะพะฒ:"

# ============================================================================
# ะะขะะะะะซะ ะะะะฃะะฌะขะะข
# ============================================================================
echo ""
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${BLUE}โ  ๐ ะะขะะะะะซะ ะะะะฃะะฌะขะะข                                    โ${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"

TOTAL_CHECKS=$((CHECKS_PASSED + CHECKS_FAILED))

echo ""
echo -e "   ${GREEN}โ ะัะพะนะดะตะฝะพ ะฟัะพะฒะตัะพะบ: $CHECKS_PASSED${NC}"
echo -e "   ${RED}โ ะะต ะฟัะพะนะดะตะฝะพ ะฟัะพะฒะตัะพะบ: $CHECKS_FAILED${NC}"
echo -e "   ๐ ะัะตะณะพ ะฟัะพะฒะตัะพะบ: $TOTAL_CHECKS"
echo ""

if [ $CHECKS_FAILED -eq 0 ]; then
    echo -e "${GREEN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
    echo -e "${GREEN}โ  ๐ ะะกะ ะะะะะะะะ ะะะะะะะะซ ะฃะกะะะจะะ!                        โ${NC}"
    echo -e "${GREEN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
    exit 0
else
    echo -e "${RED}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
    echo -e "${RED}โ  โ๏ธ  ะะะะะะฃะะะะซ ะะะะะะะะซ - ะกะะะขะะะขะ ะะซะจะ                   โ${NC}"
    echo -e "${RED}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
    exit 1
fi
